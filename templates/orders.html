{% extends "base.html" %}
{% block content %}
<h2>我的訂單</h2>

{% if orders %}
    {% for order in orders %}
        <h3>訂單編號：{{ order.order_id }}</h3>
        {% if order.created_at %}
            <p>下單時間：{{ order.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</p>
        {% endif %}
        <table border="1" cellpadding="5" cellspacing="0">
            <thead>
                <tr>
                    <th>商品名稱</th>
                    <th>數量</th>
                    <th>單價</th>
                    <th>小計</th>
                </tr>
            </thead>
            <tbody>
                {% for product_id, item in order.products.items() %}
                    <tr>
                        <td>{{ item.name }}</td>
                        <td>{{ item.quantity }}</td>
                        <td>{{ "%.2f"|format(item.price|float) }}</td>
                        <td>{{ "%.2f"|format((item.price|float) * (item.quantity|float)) }}</td>
                    </tr>
                {% endfor %}
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="3" style="text-align: right;"><strong>總計：</strong></td>
                    <td><strong>{{ "%.2f"|format(order.total|float) }}</strong></td>
                </tr>
            </tfoot>
        </table>
        <br>
    {% endfor %}
{% else %}
    <p>你還沒有任何訂單。</p>
{% endif %}

{% endblock %}
