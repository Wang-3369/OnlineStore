<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>{{ title or "北寧路早餐店" }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <header>
        <h1>北寧路早餐店</h1>
        
        <nav>
            <a href="/">首頁</a>
            <a href="/cart">購物車</a>
            {% if session.get("username") %}
                {% if session.get("role") in ["admin", "sub-admin"] %}
                    <a href="/admin">商品管理</a>
                    <a href="/admin/orders">接單系統</a>
                    <a href="/admin/user">人員管理</a>
                {% endif %}
                <a href="/logout">登出</a>
            {% else %}
                <a href="/login">登入</a>
                <a href="/register">註冊</a>
            {% endif %}
        </nav>

        <!-- 使用者圖示 + 滑出選單容器 -->
        <div id="user-container">
            <img 
                id="user-icon" 
                src="{% if session.get('avatar') %}/api/profile/avatar/{{ session.get('avatar') }}{% else %}{{ session.get('google_avatar') or url_for('static', filename='images/user.png') }}{% endif %}" 
                alt="使用者圖示"
            >
            
            <div id="user-slide-menu">
                {% if session.get("username") %}
                    <p id="username">使用者：{{ session.get("username") }}</p>
                    <button id="orders-btn">查看訂單</button>
                    <button id="profile-btn">使用者介面</button>
                    <button id="logout-btn">登出</button>
                {% else %}
                    <p id="user-status">未登入</p>
                    <button id="login-btn">登入</button>
                {% endif %}
            </div>
        </div>

    </header>

    <main>
        {% block content %}{% endblock %}
    </main>

    <footer>
        <p>©北寧路早餐店</p>
    </footer>

    <script defer src="{{ url_for('static', filename='js/user_popup.js') }}"></script>
</body>
</html>
